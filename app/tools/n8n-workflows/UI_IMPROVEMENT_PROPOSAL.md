# n8nワークフローUI改善提案書

## 📋 現状の問題点

### 1. **UIレイアウトの崩れ**
- 統計カードが横並びにならず縦に並んでいる
- 検索バーとn8nダッシュボードボタンの配置がおかしい
- カード内のコンテンツが適切に整列していない

### 2. **情報の不足**
現在表示されている情報：
- ✅ ワークフロー名（日本語・英語）
- ✅ ステータス（稼働中/テスト中/非推奨）
- ✅ カテゴリ（出品/在庫など）
- ✅ バージョン
- ✅ 説明文
- ✅ Webhook Path

**足りない情報：**
- ❌ ローカルJSONファイル名（例：`【出品】01_ローカル-eBay出品処理-完成版v6修正_V7.json`）
- ❌ n8n実ワークフローIDとの紐付け状況
- ❌ UIボタンとの連携状況（どのページのどのボタンから実行できるか）
- ❌ ワークフローのタイプ（AIエージェント/通常ワークフロー/Python連携）
- ❌ 高校生でもわかる簡易説明（何をするツールか？いつ動くか？何が起きるか？）
- ❌ 依存関係（他のワークフローや外部サービスとの連携）

### 3. **ボタンの機能未実装**
- 「詳細」ボタン → 何も起こらない
- 「実行」ボタン → 何も起こらない
- 「JSONエクスポート」ボタン → 何も起こらない

### 4. **データソースの不一致**
- 実際のJSONファイル（170+件）が存在する可能性
- `workflow-registry.ts`には10件しか登録されていない
- JSONファイルとworkflow-registry.tsの同期が取れていない

---

## 🎯 理想的なUI設計案

### A案：**ワークフロー管理ダッシュボード（詳細型）**

#### レイアウト
```
┌─────────────────────────────────────────────────────┐
│ 🔍 検索バー          [🔄同期] [📥エクスポート] [🌐n8n]  │
├─────────────────────────────────────────────────────┤
│ 📊 統計（横並び4列）                                  │
│ [総数: 170] [アクティブ: 45] [未連携: 80] [エラー: 5] │
├─────────────────────────────────────────────────────┤
│ フィルター: [すべて] [出品] [在庫] [AI] ...           │
│ ステータス: [すべて] [稼働中] [未連携] [エラー]        │
├─────────────────────────────────────────────────────┤
│ ┌──────────────── ワークフローカード ──────────────┐ │
│ │ 📦 出品予約  [稼働中] [出品] v1.0.0                │ │
│ │ Listing Reserve                                  │ │
│ │                                                   │ │
│ │ 🎓 何をする？ → eBayに商品を自動で出品する        │ │
│ │ ⏰ いつ動く？ → 「出品」ボタンを押したとき         │ │
│ │ ✨ 何が起きる？→ 商品データがeBayに送信される     │ │
│ │                                                   │ │
│ │ 📁 ファイル: listing-reserve.json                │ │
│ │ 🔗 Webhook: /webhook/listing-reserve             │ │
│ │ 🎮 UI連携: [editing-n3: 出品ボタン]              │ │
│ │ 🤖 タイプ: 通常ワークフロー                       │ │
│ │                                                   │ │
│ │ [📋詳細を見る] [▶実行テスト] [🔗n8nで開く]       │ │
│ └─────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────┘
```

#### 表示する情報
1. **基本情報**
   - ワークフロー名（日・英）
   - ステータスバッジ（色分け）
   - カテゴリバッジ
   - バージョン

2. **高校生向け3行説明**
   - 🎓 何をする？
   - ⏰ いつ動く？
   - ✨ 何が起きる？

3. **技術情報**
   - 📁 JSONファイル名
   - 🔗 Webhook Path
   - 🆔 n8n Workflow ID
   - 🤖 タイプ（通常/AIエージェント/Python/Cron）

4. **連携情報**
   - 🎮 UI連携先（どのページのどのボタン）
   - 🔌 依存サービス（Supabase/eBay API/AI等）
   - 📊 実行統計（過去7日間の実行回数・成功率）

5. **アクション**
   - 📋 詳細モーダルを開く
   - ▶ テスト実行（パラメータ入力UI）
   - 🔗 n8nダッシュボードで開く
   - 📥 JSON定義をダウンロード

---

### B案：**シンプル一覧型（軽量）**

現在のデザインをベースに、情報を追加しスペーシングを修正

```
┌────────────────────────────────────────┐
│ 📦 出品予約                            │
│ [稼働中] [出品] v1.0.0                 │
│                                        │
│ 📝 eBayに商品を自動出品します          │
│                                        │
│ 🎓 出品ボタンを押すと商品がeBayに送信   │
│                                        │
│ 📁 listing-reserve.json                │
│ 🎮 editing-n3: 出品ボタン → ⚡️稼働中   │
│                                        │
│ [詳細] [実行]                          │
└────────────────────────────────────────┘
```

---

## 🔧 実装に必要な作業

### 1. **workflow-registry.tsの拡充**
現在の定義に以下を追加：
```typescript
export interface N8nWorkflow {
  // ... 既存フィールド
  
  // 追加フィールド
  jsonFilename?: string;          // ローカルJSONファイル名
  workflowType: 'standard' | 'ai-agent' | 'python' | 'cron'; // タイプ
  simpleExplain: string;          // 何をするか（高校生向け）
  whenRuns: string;               // いつ動くか
  whatHappens: string;            // 何が起きるか
  uiConnections?: {               // UI連携情報
    page: string;                 // ページ（editing-n3など）
    button: string;               // ボタン名
    status: 'active' | 'inactive';
  }[];
  dependencies?: {                // 依存サービス
    services: string[];           // ['Supabase', 'eBay API']
    workflows: string[];          // 依存する他のワークフロー
  };
  stats?: {                       // 実行統計
    last7days: number;
    successRate: number;
  };
}
```

### 2. **UIコンポーネントの修正**
- N3Gridのcolumns設定を修正（4列表示）
- カード内のスペーシング調整
- 高校生向け説明セクションの追加
- 連携情報の表示
- ボタンの機能実装

### 3. **データ同期**
- 実際のJSONファイルをスキャン
- workflow-registry.tsに一括登録
- n8n APIから実ワークフローIDを取得

---

## 💡 推奨アプローチ

### フェーズ1：UI修正（即時対応）
1. レイアウトの崩れを修正
2. 統計カードを横並びに
3. スペーシングを調整

### フェーズ2：情報追加（短期）
1. 高校生向け3行説明を追加
2. JSONファイル名を表示
3. ワークフロータイプを表示

### フェーズ3：機能実装（中期）
1. 「詳細」ボタン → モーダル表示
2. 「実行」ボタン → テスト実行
3. UI連携情報の可視化

### フェーズ4：データ統合（長期）
1. 170+件のJSONファイルをスキャン
2. workflow-registry.tsに自動登録
3. n8n APIと同期

---

## 🎨 デザイン参考

### 既存のN3ツール
- **editing-n3**: 3カラムレイアウト、フィルタータブ
- **listing-n3**: L2タブ、統計カード、アクションボタン
- **operations-n3**: ステータスバッジ、詳細モーダル

### 目指すべきUI
- **GitHub Actions**: ワークフロー一覧、実行履歴、ログ表示
- **Zapier Dashboard**: トリガー/アクション、連携状況
- **n8n UI**: ノードベースのワークフロー表示

---

## ❓ 質問事項

1. **優先度**: A案（詳細型）とB案（シンプル型）どちらが良いか？
2. **実装範囲**: フェーズ1-4のどこまでを今回実装するか？
3. **JSONファイル**: 170+件のJSONファイルの場所はどこか？
4. **UI連携**: 既存のN3ツールで実際にn8nワークフローを呼び出している箇所はあるか？

---

## 📝 次のステップ

ユーザーからのフィードバックを受けて：
1. UIデザイン案の確定
2. 実装優先度の決定
3. データソースの確認
4. 段階的な実装開始
