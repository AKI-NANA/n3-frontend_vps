# Research N3 V2 セットアップ&使用マニュアル

## 📋 概要

Research N3 V2は、複数のマーケットプレイス（Amazon、eBay、Yahoo等）に対応した統合リサーチツールです。Keepa APIやeBay Browse APIを活用し、商品のリサーチから分析、スコアリング、仕入先探索まで一貫したワークフローを提供します。

## 🚀 初期設定

### 1. 環境変数の設定

`.env.local` ファイルに以下のAPI キーを追加してください：

```env
# Keepa API (必須)
KEEPA_API_KEY=your_keepa_api_key_here

# 既に設定済みのもの（確認）
EBAY_CLIENT_ID=xxx
EBAY_CLIENT_SECRET=xxx
EBAY_DEV_ID=xxx
```

### 2. Keepa API取得方法

1. [Keepa.com](https://keepa.com/#!api) にアクセス
2. アカウント作成（有料プラン必要）
3. API Accessページから API Key を取得
4. 月額約$20〜、トークンベースの課金

### 3. eBay API認証

1. `/tools/settings-n3` の eBay タブにアクセス
2. 「認証」ボタンをクリック
3. eBayにログインして権限を許可

## 📊 主な機能

### マーケットプレイス別機能

#### 🟠 Amazon (Keepa API)
- **ASIN一括リサーチ**: 最大1000個のASINを一括処理
- **価格履歴分析**: 90日間の価格変動データ
- **在庫切れ検知**: P-4戦略（市場枯渇）の自動スコアリング
- **価格ミス検知**: P-1戦略（価格下落）の自動検出
- **マルチリージョン対応**: JP, US, UK, DE, FR, IT, ES, CA

#### 🔴 eBay (Browse API)
- **売れ筋分析**: Sold Listingsからの高需要商品発見
- **セラー分析**: 成功セラーの販売履歴追跡
- **キーワード検索**: カテゴリ別の商品リサーチ
- **Item ID一括処理**: 商品IDによる詳細データ取得

#### 🔵 Yahoo Auctions
- **オークション分析**: 終了済み・進行中オークションの分析
- **価格トレンド**: 落札価格の推移分析
- **出品者評価**: 信頼できる仕入先の特定

## 🔄 ワークフロー

### 1. リサーチフェーズ
```
1. サイドバーからマーケットプレイスを選択
2. リサーチモードを選択（ASIN/キーワード/セラー）
3. データ入力または CSV インポート
4. 「リサーチ開始」をクリック
```

### 2. 分析フェーズ
```
1. 「分析」タブに移動
2. リサーチ結果の確認
3. スコアと利益率でソート
4. 高スコア商品を選択
```

### 3. スコアリングフェーズ
```
1. 「スコアリング」タブで上位商品確認
2. 各種スコアの詳細確認：
   - 総合スコア（0-100）
   - 利益スコア
   - 需要スコア
   - 競合スコア
   - リスクスコア
```

### 4. 仕入先探索フェーズ
```
1. 「仕入先探索」タブに移動
2. 選択商品の仕入先候補表示
3. 価格比較と在庫確認
4. 最適な仕入先を決定
```

## 📈 スコアリングアルゴリズム

### P-4戦略スコア（市場枯渇）
- **在庫切れ頻度**: 40点
- **価格上昇率**: 30点
- **BSRボラティリティ**: 20点
- **現在の機会**: 10点

### P-1戦略スコア（価格ミス）
- **価格下落率**: 50点
- **下落速度**: 20点
- **歴史的安定性**: 15点
- **BSR品質**: 15点

### 推奨基準
- **70点以上**: 優先的に仕入れ推奨
- **40-69点**: 検討価値あり
- **40点未満**: スキップ推奨

## 🎯 使用例

### ケース1: Amazon ASIN一括リサーチ

```
1. Amazon を選択
2. ASIN モードを選択
3. 以下のようにASINを入力：
   B08N5WRWNW
   B07XJ8BKDS
   B09YV3K3SY
4. リサーチ開始
5. 結果から高スコア商品を選択
6. 仕入先探索で最安値確認
```

### ケース2: eBay売れ筋分析

```
1. eBay を選択
2. 売れ筋分析モードを選択
3. キーワード入力（例: "vintage watch"）
4. フィルター設定：
   - 商品状態: 新品
   - 価格帯: $100-$1000
5. リサーチ開始
6. 売れ行きの良い商品パターンを分析
```

## 💡 Tips & ベストプラクティス

### 効率的なリサーチのコツ

1. **バッチ処理の活用**
   - Excel/Googleスプレッドシートから直接コピペ
   - 1回の処理で最大1000件まで可能
   - API制限に注意（Keepaは月間トークン制限あり）

2. **フィルター活用**
   - 最低利益率: 20%以上に設定
   - BSR: 50,000以下に限定
   - 価格帯: 仕入可能な範囲に設定

3. **マルチマーケット戦略**
   - 同じ商品を複数市場で比較
   - 地域差を活用した裁定取引
   - 季節商品の地域差活用

## ⚠️ 注意事項

### API制限
- **Keepa**: 月間トークン制限あり
- **eBay**: 1日5,000コール制限
- **スクレイピング**: レート制限実施

### データ精度
- リアルタイムデータではない場合あり
- 在庫状況は常に最新確認が必要
- 価格は為替変動の影響を受ける

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### Q: Keepa APIエラーが出る
A: 
1. API キーが正しく設定されているか確認
2. トークン残量を確認（/api/keepa/token-status）
3. 月間制限に達していないか確認

#### Q: eBay認証が失敗する
A: 
1. /tools/settings-n3 から再認証
2. リダイレクトURLが正しいか確認
3. アプリ権限を確認

#### Q: データが取得できない
A:
1. ネットワーク接続を確認
2. API制限に達していないか確認
3. 入力データの形式を確認

## 🔐 セキュリティ

- APIキーは環境変数で管理
- HTTPSで通信を暗号化
- ユーザーごとのアクセス制御実装

## 📝 更新履歴

### v2.0.0 (2024-12-26)
- サイドバーナビゲーション追加
- マーケットプレイス別UI実装
- Keepa API統合
- リサーチ→分析→スコアリング→仕入先探索の統合フロー
- P-4/P-1戦略スコアリング実装

## 📞 サポート

問題が解決しない場合は、以下にお問い合わせください：
- Slack: #n3-support
- Email: support@n3platform.com
