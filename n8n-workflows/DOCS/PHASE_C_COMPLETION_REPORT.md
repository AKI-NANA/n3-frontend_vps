# N3 Empire OS - Phase C å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## æ—¥ä»˜: 2026-01-27

---

## âœ… Phase C-1: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«çµ±ä¸€ (å®Œäº†)

### æ—¢å­˜æ§‹é€ ç¢ºèª
Workspace (`/app/tools/workspace/page.tsx`) ã¯æ—¢ã«æ­£ã—ã„æ§‹é€ :

```tsx
<div className="workspace-container" style={{ 
  height: '100vh',
  overflow: 'hidden',  // ãƒ«ãƒ¼ãƒˆã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¦æ­¢
}}>
  <div className="workspace-tool-container" style={{ 
    flex: 1, 
    overflow: 'hidden',  // å„ãƒ„ãƒ¼ãƒ«ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ¶å¾¡
  }}>
```

**çµæœ**: ä¿®æ­£ä¸è¦ã€‚æ­£ã—ã„æ§‹é€ ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹ã€‚

---

## âœ… Phase C-2: è‡ªå‹•åŒ–ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒè¨­è¨ˆ (å®Œäº†)

### DB Schema
```
/docs/sql/automation_settings.sql
```

**ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ :**
- `automation_settings`: ãƒ„ãƒ¼ãƒ«è‡ªå‹•åŒ–è¨­å®š
  - tool_id, tool_name, category
  - enabled (ON/OFF)
  - cron_expression
  - run_window_start / run_window_end
  - priority, max_concurrent, timeout
  - depends_on (ä¾å­˜é–¢ä¿‚)
  - last_run_at, last_status, next_run_at

### API
```
/app/api/automation/settings/route.ts
```

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**
- `GET`: å…¨è¨­å®šå–å¾—
- `POST`: å€‹åˆ¥è¨­å®šæ›´æ–°/ãƒˆã‚°ãƒ«
- `PUT`: ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒ (enable_all / disable_all)

### UI
```
/app/tools/control-n3/components/panels/automation-control-panel.tsx
```

**æ©Ÿèƒ½:**
- å…¨è‡ªå‹•ON/OFFï¼ˆãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒï¼‰
- ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ¶å¾¡
- å€‹åˆ¥ãƒ„ãƒ¼ãƒ«ãƒˆã‚°ãƒ«
- å®Ÿè¡Œæ™‚é–“å¸¯ãƒãƒƒãƒ—ï¼ˆ24æ™‚é–“è¡¨ç¤ºï¼‰
- æœ€çµ‚å®Ÿè¡ŒçŠ¶æ…‹ãƒ»æ¬¡å›å®Ÿè¡Œè¡¨ç¤º

---

## âœ… Phase C-5: å¤–éƒ¨APIè¨­å®šæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ  (å®Œäº†)

### API
```
/app/api/health/apis/route.ts
```

**ãƒã‚§ãƒƒã‚¯å¯¾è±¡API:**
- Supabase
- eBay API
- Amazon PA-API
- Keepa
- OpenAI
- Anthropic (Claude)
- ElevenLabs
- YouTube Data API
- n8n
- Rakuten API
- ChatWork

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:**
- `ok`: æ­£å¸¸æ¥ç¶š
- `error`: æ¥ç¶šã‚¨ãƒ©ãƒ¼
- `warning`: éƒ¨åˆ†çš„ãªè¨­å®šä¸è¶³
- `unconfigured`: æœªè¨­å®š

---

## âœ… Phase C-6: å®Œå…¨ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ– (å®Œäº†)

### API
```
/app/api/health/smoke-test/route.ts
```

**ãƒ†ã‚¹ãƒˆé …ç›®:**
1. Database Connection (Supabase)
2. n8n Health
3. Dispatch API
4. n8n Webhook Endpoint
5. Automation Settings Table
6. Products Master
7. Inventory Master
8. eBay Tokens

### UI
```
/app/tools/control-n3/components/panels/system-health-panel.tsx
```

**æ©Ÿèƒ½:**
- å¤–éƒ¨API Health ä¸€è¦§è¡¨ç¤º
- ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å…¨ä½“ãƒ†ã‚¹ãƒˆ
- ãƒ†ã‚¹ãƒˆçµæœè©³ç´°è¡¨ç¤º

---

## ğŸ“Š Control Center ã‚¿ãƒ–æ§‹æˆ (11ã‚¿ãƒ–)

| # | ã‚¿ãƒ–å | æ©Ÿèƒ½ |
|---|--------|------|
| 1 | Job Monitor | å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ç›£è¦– |
| 2 | Failed Jobs | å¤±æ•—ã‚¸ãƒ§ãƒ–ç®¡ç† |
| 3 | Workflows | n8nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç† |
| 4 | Tools Registry | å…¨ãƒ„ãƒ¼ãƒ«ä¸€è¦§ãƒ»ç®¡ç† |
| 5 | **Automation** | è‡ªå‹•åŒ–ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒ (NEW) |
| 6 | **Health** | API Health & ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ (NEW) |
| 7 | Metrics | ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º |
| 8 | Usage | ä½¿ç”¨é‡ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ |
| 9 | Approvals | æ‰¿èªå¾…ã¡ç®¡ç† |
| 10 | System | ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
| 11 | Manual | æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ |

---

## ğŸ“ Phase C ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### æ–°è¦ä½œæˆ

**SQL:**
```
/docs/sql/automation_settings.sql
```

**API:**
```
/app/api/automation/settings/route.ts
/app/api/health/apis/route.ts
/app/api/health/smoke-test/route.ts
```

**UI:**
```
/app/tools/control-n3/components/panels/automation-control-panel.tsx
/app/tools/control-n3/components/panels/system-health-panel.tsx
```

### ä¿®æ­£

```
/app/tools/control-n3/components/command-center-content.tsx
  - importè¿½åŠ : AutomationControlPanel, SystemHealthPanel, HeartPulse
  - TabIdè¿½åŠ : 'automation', 'health'
  - TABSè¿½åŠ : Automation, Health
  - ã‚¿ãƒ–åˆ‡æ›¿è¿½åŠ 
```

---

## ğŸ“‹ Phase C å®Œäº†æ¡ä»¶ãƒã‚§ãƒƒã‚¯

| æ¡ä»¶ | çŠ¶æ…‹ |
|------|------|
| ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«1æœ¬ã®ã¿ | âœ… Workspaceæ§‹é€ ç¢ºèªæ¸ˆ |
| è‡ªå‹•åŒ–ON/OFFå¯èƒ½ | âœ… Automation Control Panel |
| å¤œé–“è‡ªå‹•å®Ÿè¡Œå¯èƒ½ | âœ… cron + run_window è¨­å®šå¯èƒ½ |
| APIæœªè¨­å®šãŒå³æ¤œçŸ¥å¯èƒ½ | âœ… API Health Panel |
| ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å…¨ä½“ãƒ†ã‚¹ãƒˆå¯èƒ½ | âœ… Smoke Test Button |

---

## ğŸ”œ æœªå®Ÿè£…é …ç›®ï¼ˆPhase C-3, C-4, C-7ï¼‰

### C-3: n8n ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©
- `n3-master-scheduler` ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆå¿…è¦
- automation_settings â†’ Dispatch é€£æº

### C-4: Pipeline Status 
- products_master ã« `pipeline_status` ã‚«ãƒ©ãƒ è¿½åŠ 
- RAW â†’ RESEARCHED â†’ SCORED â†’ READY_TO_LIST â†’ LISTED

### C-7: ãƒãƒ‹ãƒ¥ã‚¢ãƒ«è‡ªå‹•ç”Ÿæˆ
- `/docs/system-map.md` ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

---

## ğŸ—ï¸ æœ€çµ‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Control Center (11 tabs)                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Monitor â”‚ Failed  â”‚ Workflows â”‚ Tools   â”‚Automationâ”‚ â”‚
â”‚ â”‚         â”‚ Jobs    â”‚           â”‚ Registryâ”‚ Control  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Health  â”‚ Metrics â”‚ Usage     â”‚Approvalsâ”‚ System   â”‚ â”‚
â”‚ â”‚ Check   â”‚         â”‚           â”‚         â”‚          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Layer                                               â”‚
â”‚ /api/automation/settings   â†’ automation_settings DB     â”‚
â”‚ /api/health/apis          â†’ External API ping           â”‚
â”‚ /api/health/smoke-test    â†’ Full system test            â”‚
â”‚ /api/dispatch             â†’ n8n webhook                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ n8n (160.16.120.186:5678)                              â”‚
â”‚ Webhooks â†’ Workflows â†’ External APIs â†’ DB Updates      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase (PostgreSQL)                                   â”‚
â”‚ - products_master                                       â”‚
â”‚ - inventory_master                                      â”‚
â”‚ - automation_settings                                   â”‚
â”‚ - job_queue                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å„ªå…ˆåº¦ é«˜
1. **SQLã‚’Supabaseã«å®Ÿè¡Œ**: `/docs/sql/automation_settings.sql`
2. **n8n ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ä½œæˆ**: `n3-master-scheduler`

### å„ªå…ˆåº¦ ä¸­
3. Pipeline Status ã‚«ãƒ©ãƒ è¿½åŠ 
4. ãƒãƒ‹ãƒ¥ã‚¢ãƒ«è‡ªå‹•ç”Ÿæˆ

### å„ªå…ˆåº¦ ä½
5. Phase D-Hï¼ˆHubå¼·åŒ–ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€ãƒ†ã‚¹ãƒˆï¼‰

